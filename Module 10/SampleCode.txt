def extract_and_dump_config(file_path, config_folder):
  try:
    pe = pefile.PE(file_path)
    head, tail = os.path.split(file_path)

    config = ""
    section_data = ""

    for section in pe.sections:
      name = (section.Name).decode('utf-8').replace("\x00","")
      data = section.get_data()
      section_data = data
      key_len = 0x20
      key = section_data[:key_len]
      crc = section_data[key_len:key_len+0x4]
      config_len = int.from_bytes(section_data[key_len+0x4:key_len+0x8], "little")
      data_3_hex = section_data[key_len+0x8:config_len+key_len+0x8]
      
      cipher = ARC4(key)
      dump = cipher.decrypt(data_3_hex)

      if "pid" in dump.decode('ascii', 'ignore'):
          f = open(config_folder + "//" + tail + "_config_decoded.txt", "wb")
          f.write(bytearray(dump))
          f.close()
          
          cfg = json.loads(dump[:-1])
          continue
  except Exception:
    return